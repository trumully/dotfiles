function Add-TerminalProfileCatppuccin {
    # Define the path for the fragment file
    $fragmentPath = "$env:LOCALAPPDATA\Microsoft\Windows Terminal\Fragments\Catppuccin\catppuccin.json"

    # Ensure the directory exists
    $fragmentDir = [System.IO.Path]::GetDirectoryName($fragmentPath)
    if (-not (Test-Path -Path $fragmentDir)) {
        New-Item -ItemType Directory -Path $fragmentDir -Force
    }

    Copy-Item "{{ .chezmoi.workingTree }}\fragment\catppuccin.json" $fragmentDir

    Write-Output "Fragment has been created successfully at $fragmentPath"
    Write-Output "Restart Windows Terminal and then select or set the theme in your profile"
}

# Call the function to install the Catppuccin theme Fragment
Add-TerminalProfileCatppuccin